# i18n Documentation for LangSum

## Overview
The i18n system in LangSum supports multilingual features, allowing the application to adapt to different languages. This document focuses on the admin i18n page and its translation tools, which were recently enhanced for better usability and debugging.

## Admin i18n Page (/admin/i18n)
- **Purpose**: Provides an interface for administrators to manage translations, import missing keys, and perform batch or per-key translations using an AI backend.
- **Key Features**:
  - Locale selector for choosing target languages (e.g., all 28 EU languages).
  - Import missing keys button to pull untranslated keys from English.
  - Batch Translate button for translating multiple keys sequentially with progress tracking and cancel option.
  - Per-key Translate button for individual key translation with immediate UI feedback.
  - Debug panel (toggleable) to log AI translation details, including prompts, sources, and destinations.
- **UI Components**:
  - Uses HTML elements like `select`, `progress`, and custom JavaScript for dynamic updates.
  - Flash effect on translated keys for visual feedback.
  - Event listeners handle save, translate, and cancel actions.

## Translation Tool Mechanics
- **Frontend (src/frontend/pages/admin-i18n.html)**:
  - Calls backend endpoint `/i18n-admin/translate-key` for each key translation.
  - Handles asynchronous requests with `async/await`, updating the UI row-by-row or in batch mode.
  - Debug logs capture and display the full AI prompt, source, and destination for each translation.
- **Backend (src/backend/app/api/i18n_admin.py)**:
  - Endpoint `POST /i18n-admin/translate-key`:
    - Accepts `{lang, key}` and uses AI service to translate from English.
    - Masks placeholders (e.g., {name}) to preserve them, translates, then unmasks.
    - Retries if output matches source, with stricter rules (e.g., use localized forms).
    - Trims unintended punctuation and returns `{ok, key, src, dst, prompt, retry_prompt}` for debugging.
  - Relies on `ai_service.py` for AI calls, with enhanced prompts to ensure accurate translations.

## Recent Enhancements
- Added per-key and batch translation with AI integration.
- Improved debug visibility to include prompts and retry attempts.
- Ensured dynamic UI updates without full page reloads for better user experience.

This documentation can be expanded with more details or examples as needed.
